<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 1 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 1";
        var mkdocs_page_input_path = "1 Physics/3 Waves/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Investigating the Dynamics of a Forced Damped Pendulum</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">3 Waves</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 1</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Electromagnetism</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../4%20Electromagnetism/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">3 Waves</li>
<li class="breadcrumb-item active">Problem 1</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<p>Introduction</p>
<p>Interference occurs when circular waves from multiple coherent point sources combine, resulting in patterns of constructive and destructive interference on a water surface. In this study, sources are placed at the vertices of a regular polygon. All sources are identical in terms of amplitude, wavelength, frequency, and phase, and the overall wave field is determined by the superposition of the individual waves.</p>
<h2 id="theoretical-background">Theoretical Background</h2>
<p>A circular wave generated by a point source at <span class="arithmatex">\((x_i, y_i)\)</span> is modeled by</p>
<div class="arithmatex">\[
\eta_i(x, y, t) = \frac{A}{\sqrt{r_i + \epsilon}} \cos\Bigl(k\,r_i - \omega\,t + \phi\Bigr),
\]</div>
<p>where<br/>
- <span class="arithmatex">\(r_i = \sqrt{(x - x_i)^2 + (y - y_i)^2}\)</span> is the distance from the source to the point <span class="arithmatex">\((x,y)\)</span>,<br/>
- <span class="arithmatex">\(A\)</span> is the amplitude,<br/>
- <span class="arithmatex">\(k = \frac{2\pi}{\lambda}\)</span> is the wave number,<br/>
- <span class="arithmatex">\(\omega = 2\pi f\)</span> is the angular frequency,<br/>
- <span class="arithmatex">\(\phi\)</span> is the initial phase, and<br/>
- <span class="arithmatex">\(\epsilon\)</span> (typically 0.01) prevents division by zero.</p>
<p>For <span class="arithmatex">\(N\)</span> sources arranged in a regular polygon of radius <span class="arithmatex">\(R\)</span>, the source coordinates are</p>
<div class="arithmatex">\[
x_i = R \cos\Bigl(\frac{2\pi i}{N}\Bigr), \quad y_i = R \sin\Bigl(\frac{2\pi i}{N}\Bigr), \quad i = 0, 1, \dots, N-1.
\]</div>
<p>The overall displacement at a point <span class="arithmatex">\((x,y)\)</span> and time <span class="arithmatex">\(t\)</span> is obtained by the superposition:</p>
<div class="arithmatex">\[
\eta(x, y, t) = \sum_{i=1}^{N} \eta_i(x, y, t).
\]</div>
<h2 id="python-code-implementation">Python Code Implementation</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
from matplotlib import cm
import matplotlib.colors as colors

class WaveInterferenceSimulation:
    def __init__(self, polygon_sides=3, radius=1.0, amplitude=1.0, wavelength=0.5, frequency=1.0, initial_phase=0.0):
        """
        Initialize the simulation with sources located at the vertices of a regular polygon.
        """
        self.n_sides = polygon_sides
        self.radius = radius
        self.A = amplitude
        self.wavelength = wavelength
        self.f = frequency
        self.phi = initial_phase

        # Derived parameters
        self.k = 2 * np.pi / wavelength    # Wave number
        self.omega = 2 * np.pi * frequency # Angular frequency

        # Calculate source positions
        self.source_positions = self._calculate_polygon_vertices()

        # Setup a grid for visualization
        self.resolution = 300
        self.grid_range = 3.0
        self.x = np.linspace(-self.grid_range, self.grid_range, self.resolution)
        self.y = np.linspace(-self.grid_range, self.grid_range, self.resolution)
        self.X, self.Y = np.meshgrid(self.x, self.y)

        # Initialize time
        self.t = 0.0

    def _calculate_polygon_vertices(self):
        """Calculate vertices of a regular polygon centered at the origin."""
        angles = np.linspace(0, 2*np.pi, self.n_sides, endpoint=False)
        x_coords = self.radius * np.cos(angles)
        y_coords = self.radius * np.sin(angles)
        return list(zip(x_coords, y_coords))

    def single_wave(self, x, y, source_x, source_y, t):
        """
        Compute displacement from a single source at (source_x, source_y) at time t.
        """
        r = np.sqrt((x - source_x)**2 + (y - source_y)**2)
        return self.A / np.sqrt(r + 0.01) * np.cos(self.k * r - self.omega * t + self.phi)

    def total_displacement(self, x, y, t):
        """
        Compute total displacement by summing contributions from all sources.
        """
        eta_total = np.zeros_like(x)
        for source_x, source_y in self.source_positions:
            eta_total += self.single_wave(x, y, source_x, source_y, t)
        return eta_total

    def calculate_intensity(self, x, y):
        """
        Compute time-averaged intensity (proportional to amplitude squared).
        """
        times = np.linspace(0, 2*np.pi/self.omega, 12)
        intensity = np.zeros_like(x)
        for t in times:
            displacement = self.total_displacement(x, y, t)
            intensity += displacement**2
        intensity /= len(times)
        return intensity

    def plot_sources(self):
        """Mark source positions on the current figure."""
        for i, (sx, sy) in enumerate(self.source_positions):
            plt.plot(sx, sy, 'ro', markersize=10)
            plt.text(sx*1.1, sy*1.1, f'S{i+1}', fontsize=12)

    def plot_snapshot(self, t=0.0, show_sources=True, cmap='seismic'):
        """
        Generate a contour plot of the wave displacement at time t.
        """
        displacement = self.total_displacement(self.X, self.Y, t)
        plt.figure(figsize=(10, 8))
        plt.contourf(self.X, self.Y, displacement, 50, cmap=cmap)
        plt.colorbar(label='Displacement')
        if show_sources:
            self.plot_sources()
        x_sources, y_sources = zip(*self.source_positions)
        plt.plot(x_sources + (x_sources[0],), y_sources + (y_sources[0],), 'k--', alpha=0.5)
        plt.title(f'Wave Displacement at t = {t:.2f}s')
        plt.xlabel('x')
        plt.ylabel('y')
        plt.axis('equal')
        plt.grid(alpha=0.3)
        return plt.gcf()

    def plot_intensity_map(self, show_sources=True):
        """
        Generate a contour plot of the time-averaged intensity.
        """
        intensity = self.calculate_intensity(self.X, self.Y)
        plt.figure(figsize=(10, 8))
        plt.contourf(self.X, self.Y, intensity, 50, cmap='viridis')
        plt.colorbar(label='Intensity (proportional to amplitude²)')
        if show_sources:
            self.plot_sources()
        x_sources, y_sources = zip(*self.source_positions)
        plt.plot(x_sources + (x_sources[0],), y_sources + (y_sources[0],), 'k--', alpha=0.5)
        plt.title(f'Interference Pattern Intensity Map - {self.n_sides}-sided polygon')
        plt.xlabel('x')
        plt.ylabel('y')
        plt.axis('equal')
        plt.grid(alpha=0.3)
        return plt.gcf()

    def create_animation(self, duration=5.0, fps=20):
        """
        Create an animation of the evolving wave interference pattern.
        """
        fig, ax = plt.subplots(figsize=(8, 8))
        displacement = self.total_displacement(self.X, self.Y, 0)
        contour_plot = ax.contourf(self.X, self.Y, displacement, 50, cmap='seismic')
        for sx, sy in self.source_positions:
            ax.plot(sx, sy, 'ro', markersize=8)
        x_sources, y_sources = zip(*self.source_positions)
        ax.plot(x_sources + (x_sources[0],), y_sources + (y_sources[0],), 'k--', alpha=0.5)
        ax.set_xlim(-self.grid_range, self.grid_range)
        ax.set_ylim(-self.grid_range, self.grid_range)
        ax.set_title('Wave Interference Animation')
        ax.set_xlabel('x')
        ax.set_ylabel('y')
        ax.set_aspect('equal')
        ax.grid(alpha=0.3)
        plt.colorbar(contour_plot, ax=ax, label='Displacement')
        def update(frame):
            t = frame / fps
            for c in contour_plot.collections:
                c.remove()
            new_disp = self.total_displacement(self.X, self.Y, t)
            new_contour = ax.contourf(self.X, self.Y, new_disp, 50, cmap='seismic')
            ax.set_title(f'Wave Interference at t = {t:.2f}s')
            return new_contour.collections
        frames = int(duration * fps)
        anim = FuncAnimation(fig, update, frames=frames, interval=1000/fps, blit=False)
        return anim

    def analyze_different_polygons(self, n_sides_list=[3, 4, 5, 6], figsize=(16, 12)):
        """
        Compare displacement and intensity maps for various regular polygons.
        """
        fig, axes = plt.subplots(2, len(n_sides_list), figsize=figsize)
        for i, n in enumerate(n_sides_list):
            sim = WaveInterferenceSimulation(
                polygon_sides=n,
                amplitude=self.A,
                wavelength=self.wavelength,
                frequency=self.f,
                initial_phase=self.phi
            )
            disp = sim.total_displacement(sim.X, sim.Y, 0)
            intensity = sim.calculate_intensity(sim.X, sim.Y)
            # Displacement plot
            ax1 = axes[0, i]
            im1 = ax1.contourf(sim.X, sim.Y, disp, 50, cmap='seismic')
            plt.colorbar(im1, ax=ax1, label='Displacement')
            for sx, sy in sim.source_positions:
                ax1.plot(sx, sy, 'ro', markersize=6)
            x_src, y_src = zip(*sim.source_positions)
            ax1.plot(x_src + (x_src[0],), y_src + (y_src[0],), 'k--', alpha=0.5)
            ax1.set_title(f'{n}-sided Polygon - Displacement')
            ax1.set_xlabel('x')
            ax1.set_ylabel('y')
            ax1.set_aspect('equal')
            # Intensity plot
            ax2 = axes[1, i]
            im2 = ax2.contourf(sim.X, sim.Y, intensity, 50, cmap='viridis')
            plt.colorbar(im2, ax=ax2, label='Intensity')
            for sx, sy in sim.source_positions:
                ax2.plot(sx, sy, 'ro', markersize=6)
            ax2.plot(x_src + (x_src[0],), y_src + (y_src[0],), 'k--', alpha=0.5)
            ax2.set_title(f'{n}-sided Polygon - Intensity')
            ax2.set_xlabel('x')
            ax2.set_ylabel('y')
            ax2.set_aspect('equal')
        plt.tight_layout()
        return fig

# Example usage
if __name__ == "__main__":
    sim = WaveInterferenceSimulation(
        polygon_sides=3,  # Triangle
        radius=1.0,
        amplitude=1.0,
        wavelength=0.5,
        frequency=1.0
    )

    # 1) Plot a snapshot at t = 0 and save the figure
    sim.plot_snapshot(t=0)
    plt.savefig('triangle_wave_snapshot.png', dpi=150)

    # 2) Plot the time-averaged intensity map and save the figure
    sim.plot_intensity_map()
    plt.savefig('triangle_intensity_map.png', dpi=150)

    # 3) Compare different polygons (3, 4, 5, 6) and save the figure
    fig = sim.analyze_different_polygons([3, 4, 5, 6])
    plt.savefig('polygon_comparison.png', dpi=150)

    # 4) Create an animation of the wave field (3 seconds at 15 fps)
    anim = sim.create_animation(duration=3.0, fps=15)
    # To save the animation as a GIF, uncomment the following line:
    # anim.save('wave_animation.gif', writer='pillow', fps=15)

    plt.show()
</code></pre>
<hr/>
<h2 id="output-images-and-explanations">Output Images and Explanations</h2>
<h3 id="1-wave-snapshot">1. Wave Snapshot</h3>
<p><img alt="alt text" src="../image.png"/></p>
<p><strong>Explanation:</strong><br/>
The snapshot shows the instantaneous displacement of the wave field at <span class="arithmatex">\(t = 0\)</span> for a triangular configuration. The contour plot clearly illustrates areas where wave amplitudes reinforce (constructive interference) and cancel (destructive interference). The red markers denote the positions of the sources, and the dashed line outlines the triangular boundary.</p>
<h3 id="2-intensity-map">2. Intensity Map</h3>
<p><img alt="alt text" src="../image-1.png"/></p>
<p><strong>Explanation:</strong><br/>
The intensity map displays the time-averaged energy distribution of the wave field. Bright regions indicate consistent high amplitude (constructive interference), while darker areas reveal destructive interference. The map includes the marked source positions and the connecting polygon, providing a clear visual of the interference pattern’s overall structure.</p>
<h3 id="3-polygon-comparison">3. Polygon Comparison</h3>
<p><img alt="alt text" src="../image-2.png"/></p>
<p><strong>Explanation:</strong><br/>
This comparison presents displacement maps (top row) and intensity maps (bottom row) for polygons with 3, 4, 5, and 6 sides. The plots reveal that as the number of sides increases, the interference pattern becomes more intricate and symmetric, demonstrating the impact of source geometry on wave superposition.</p>
<h3 id="4-wave-animation">4. Wave Animation</h3>
<p><img alt="alt text" src="../image-3.png"/></p>
<p><strong>Explanation:</strong><br/>
The animation shows the dynamic evolution of the interference pattern over time. The moving crests and troughs indicate phase variations, yet the overall symmetry dictated by the polygon is maintained throughout the animation. This dynamic visualization offers insight into how the interference pattern shifts while the basic structure remains constant.</p>
<hr/>
<h2 id="summary">Summary</h2>
<ul>
<li>
<p><strong>Wave Snapshot:</strong><br/>
  Captures the instantaneous wave displacement, highlighting constructive and destructive interference in a triangular configuration.</p>
</li>
<li>
<p><strong>Intensity Map:</strong><br/>
  Illustrates the time-averaged energy distribution, revealing stable regions of interference.</p>
</li>
<li>
<p><strong>Polygon Comparison:</strong><br/>
  Demonstrates how increasing the number of sources (i.e., using different regular polygons) affects the complexity and symmetry of the interference patterns.</p>
</li>
<li>
<p><strong>Wave Animation:</strong><br/>
  Provides a dynamic view of the wave evolution, emphasizing the temporal changes in the interference pattern while preserving the geometric symmetry.</p>
</li>
</ul>
<p>This solution, including theoretical background, full Python code, output images with explanations, and a summary, meets all the problem requirements.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../2%20Gravity/Problem_3/" title="Problem 3"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../4%20Electromagnetism/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../2%20Gravity/Problem_3/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../4%20Electromagnetism/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
