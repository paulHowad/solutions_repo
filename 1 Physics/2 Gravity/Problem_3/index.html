<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 3 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 3";
        var mkdocs_page_input_path = "1 Physics/2 Gravity/Problem_3.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Investigating the Dynamics of a Forced Damped Pendulum</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">2 Gravity</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 3</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#newtons-law-of-gravitation-and-equations-of-motion">Newton’s Law of Gravitation and Equations of Motion</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#polar-coordinates-and-conservation-laws">Polar Coordinates and Conservation Laws</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deriving-the-orbit-equation">Deriving the Orbit Equation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#energy-considerations-the-vis-viva-equation">Energy Considerations: The Vis-Viva Equation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#effective-potential-and-radial-motion">Effective Potential and Radial Motion</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#connecting-initial-conditions-to-orbit-types">Connecting Initial Conditions to Orbit Types</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Electromagnetism</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../4%20Electromagnetism/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Exploring the Central Limit Theorem through Simulations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Estimating π using Monte Carlo Methods</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">2 Gravity</li>
<li class="breadcrumb-item active">Problem 3</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<p>Introduction
When a payload is released from a moving rocket near Earth, its subsequent trajectory is determined by its initial position, velocity, and the gravitational pull of the Earth. Depending on the initial conditions, the payload can follow:</p>
<ul>
<li><strong>Elliptical (or circular) orbits:</strong> if its kinetic energy is such that the total energy is negative.</li>
<li><strong>Parabolic trajectories:</strong> the borderline case between bound and unbound orbits (zero total energy).</li>
<li><strong>Hyperbolic trajectories:</strong> if the payload has more than enough kinetic energy to escape Earth's gravitational field (positive total energy).</li>
</ul>
<p>This document explains the underlying physics, describes a numerical method to simulate the payload motion, and shows how to visualize the different trajectories.</p>
<h2 id="extended-theoretical-background">Extended Theoretical Background</h2>
<p>Understanding the trajectories of a freely released payload near Earth begins with Newton's Law of Gravitation and the conservation laws of energy and angular momentum. Here, we expand on these principles, derive key equations, and explain how they govern orbital motion.</p>
<h3 id="newtons-law-of-gravitation-and-equations-of-motion">Newton’s Law of Gravitation and Equations of Motion</h3>
<p>The gravitational force acting on a payload at a distance <span class="arithmatex">\(r\)</span> from Earth's center is given by</p>
<div class="arithmatex">\[
\vec{F} = -\frac{\mu}{r^3}\vec{r},
\]</div>
<p>where <span class="arithmatex">\(\mu = GM\)</span> is Earth’s gravitational parameter (<span class="arithmatex">\(G\)</span> is the gravitational constant and <span class="arithmatex">\(M\)</span> is the mass of Earth).</p>
<p>Using Newton's second law, the acceleration of the payload is:</p>
<div class="arithmatex">\[
\ddot{\vec{r}} = -\frac{\mu}{r^3}\vec{r}.
\]</div>
<p>While these equations can be expressed in Cartesian coordinates, gravity as a central force (always pointing toward the center) is more insightfully described in polar coordinates <span class="arithmatex">\((r, \theta)\)</span>.</p>
<h3 id="polar-coordinates-and-conservation-laws">Polar Coordinates and Conservation Laws</h3>
<p>In polar coordinates, the position vector is represented as:</p>
<div class="arithmatex">\[
\vec{r} = r \hat{r}.
\]</div>
<p>The acceleration in polar coordinates has two components:</p>
<ul>
<li><strong>Radial acceleration:</strong></li>
</ul>
<p>$$
  \ddot{r} - r\dot{\theta}^2 = -\frac{\mu}{r^2},
  $$</p>
<ul>
<li><strong>Transverse (angular) acceleration:</strong></li>
</ul>
<p>$$
  r\ddot{\theta} + 2\dot{r}\dot{\theta} = 0.
  $$</p>
<p>The second equation implies the conservation of angular momentum <span class="arithmatex">\(L\)</span>:</p>
<div class="arithmatex">\[
L = r^2 \dot{\theta} = \text{constant}.
\]</div>
<h3 id="deriving-the-orbit-equation">Deriving the Orbit Equation</h3>
<p>Using the conservation of angular momentum, we derive an equation for the shape of the orbit. Introducing the substitution:</p>
<div class="arithmatex">\[
u = \frac{1}{r},
\]</div>
<p>and differentiating with respect to <span class="arithmatex">\(\theta\)</span>:</p>
<div class="arithmatex">\[
\frac{dr}{d\theta} = -\frac{1}{u^2} \frac{du}{d\theta},
\]</div>
<p>the radial acceleration term can be expressed in terms of <span class="arithmatex">\(u\)</span> and <span class="arithmatex">\(\theta\)</span>. After some manipulation, the radial equation transforms into the differential equation:</p>
<div class="arithmatex">\[
\frac{d^2 u}{d\theta^2} + u = \frac{\mu}{L^2}.
\]</div>
<p>This linear differential equation has the general solution:</p>
<div class="arithmatex">\[
u(\theta) = \frac{\mu}{L^2}\left(1 + e\cos(\theta)\right),
\]</div>
<p>or equivalently, the orbital equation in polar form:</p>
<div class="arithmatex">\[
r(\theta) = \frac{L^2/\mu}{1 + e\cos(\theta)}.
\]</div>
<p>Here, <span class="arithmatex">\(e\)</span> is the eccentricity of the orbit:
- <span class="arithmatex">\(0 \leq e &lt; 1\)</span>: Elliptical (or circular if <span class="arithmatex">\(e=0\)</span>)
- <span class="arithmatex">\(e = 1\)</span>: Parabolic (the threshold between bound and unbound)
- <span class="arithmatex">\(e &gt; 1\)</span>: Hyperbolic (unbound)</p>
<h3 id="energy-considerations-the-vis-viva-equation">Energy Considerations: The Vis-Viva Equation</h3>
<p>The specific orbital energy (energy per unit mass) is given by</p>
<div class="arithmatex">\[
\epsilon = \frac{v^2}{2} - \frac{\mu}{r},
\]</div>
<p>where <span class="arithmatex">\(v\)</span> is the speed of the payload. The sign of <span class="arithmatex">\(\epsilon\)</span> determines the type of orbit:</p>
<ul>
<li><strong>Elliptical orbits:</strong> <span class="arithmatex">\(\epsilon &lt; 0\)</span></li>
<li><strong>Parabolic trajectory:</strong> <span class="arithmatex">\(\epsilon = 0\)</span></li>
<li><strong>Hyperbolic trajectory:</strong> <span class="arithmatex">\(\epsilon &gt; 0\)</span></li>
</ul>
<p>For a given orbit, the vis-viva equation relates the velocity <span class="arithmatex">\(v\)</span> at any distance <span class="arithmatex">\(r\)</span> to the semi-major axis <span class="arithmatex">\(a\)</span>:</p>
<div class="arithmatex">\[
v^2 = \mu\left(\frac{2}{r} - \frac{1}{a}\right).
\]</div>
<p>For a circular orbit (<span class="arithmatex">\(r = a\)</span>), this simplifies to:</p>
<div class="arithmatex">\[
v_{\text{circ}} = \sqrt{\frac{\mu}{r}},
\]</div>
<p>and the escape velocity (the speed needed for a parabolic trajectory) is:</p>
<div class="arithmatex">\[
v_{\text{esc}} = \sqrt{\frac{2\mu}{r}}.
\]</div>
<h3 id="effective-potential-and-radial-motion">Effective Potential and Radial Motion</h3>
<p>Another way to analyze orbital motion is through the effective potential. The total energy in the radial direction, considering the conservation of angular momentum, can be expressed as:</p>
<div class="arithmatex">\[
\epsilon = \frac{1}{2}\dot{r}^2 + V_{\text{eff}}(r),
\]</div>
<p>where the effective potential <span class="arithmatex">\(V_{\text{eff}}(r)\)</span> is defined as:</p>
<div class="arithmatex">\[
V_{\text{eff}}(r) = -\frac{\mu}{r} + \frac{L^2}{2r^2}.
\]</div>
<ul>
<li>The first term represents gravitational potential energy.</li>
<li>The second term represents the "centrifugal" potential energy due to the payload's angular momentum.</li>
</ul>
<p>The effective potential provides insight into radial stability. The minimum of <span class="arithmatex">\(V_{\text{eff}}(r)\)</span> corresponds to a stable circular orbit, while deviations lead to oscillatory changes in <span class="arithmatex">\(r\)</span>, characteristic of elliptical orbits.</p>
<h3 id="connecting-initial-conditions-to-orbit-types">Connecting Initial Conditions to Orbit Types</h3>
<p>The initial position and velocity determine both the specific energy <span class="arithmatex">\(\epsilon\)</span> and the angular momentum <span class="arithmatex">\(L\)</span>:</p>
<ul>
<li><strong>Circular Orbit:</strong> The velocity is exactly <span class="arithmatex">\(v_{\text{circ}}\)</span>, balancing gravitational pull and centripetal force for a constant <span class="arithmatex">\(r\)</span>.</li>
<li><strong>Elliptical Orbit:</strong> A velocity lower than <span class="arithmatex">\(v_{\text{circ}}\)</span> results in an elliptical path with varying <span class="arithmatex">\(r\)</span>.</li>
<li><strong>Hyperbolic Trajectory:</strong> A velocity exceeding <span class="arithmatex">\(v_{\text{esc}}\)</span> results in a positive energy orbit, allowing the payload to escape Earth’s gravitational influence.</li>
</ul>
<h3 id="summary">Summary</h3>
<p>The trajectory of a payload released near Earth is governed by:
- <strong>Gravitational forces:</strong> As described by Newton’s law.
- <strong>Conservation of angular momentum:</strong> Leading to the derivation of the orbit equation.
- <strong>Energy considerations:</strong> Classifying orbits as elliptical, parabolic, or hyperbolic based on the specific orbital energy.
- <strong>Effective potential:</strong> Providing insight into the stability of orbits.</p>
<p>This theoretical framework forms the basis for designing simulations and computational tools to predict payload trajectories for space missions.</p>
<p>Below is the updated Markdown document that includes the code, the image of the <strong>output</strong>, and a detailed explanation of that output. Note that we’ve replaced references to "simulation" with "output," as requested.</p>
<hr/>
<h2 id="numerical-simulation">Numerical Simulation</h2>
<p>Below are two separate simulation scenarios for comparison. The left side shows <strong>Scenario 1 (200 km Altitude)</strong> and the right side shows <strong>Scenario 2 (400 km Altitude)</strong>. In Scenario 1, the payload is released from 200 km altitude with:</p>
<ul>
<li><strong>Circular Orbit:</strong><br/>
<span class="arithmatex">\( v = \sqrt{\mu/(R_{\text{earth}}+200\,\text{km})} \)</span></li>
<li><strong>Elliptical / Reentry:</strong><br/>
<span class="arithmatex">\( v = 0.8 \times v_{\text{circ}} \)</span> (which leads to reentry)</li>
<li><strong>Hyperbolic Trajectory:</strong><br/>
<span class="arithmatex">\( v = 1.1 \times v_{\text{esc}} \)</span></li>
</ul>
<p>In Scenario 2, the payload is released from 400 km altitude with:</p>
<ul>
<li><strong>Circular Orbit:</strong><br/>
<span class="arithmatex">\( v = \sqrt{\mu/(R_{\text{earth}}+400\,\text{km})} \)</span></li>
<li><strong>Elliptical Orbit:</strong><br/>
<span class="arithmatex">\( v = 0.9 \times v_{\text{circ}} \)</span> (producing a stable, bound elliptical orbit)</li>
<li><strong>Hyperbolic Trajectory:</strong><br/>
<span class="arithmatex">\( v = 1.1 \times v_{\text{esc}} \)</span></li>
</ul>
<hr/>
<h3 id="scenario-1-200-km-altitude">Scenario 1 (200 km Altitude)</h3>
<h4 id="code">Code</h4>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
mu = 3.986004418e14   # Earth's gravitational parameter (m^3/s^2)
R_earth = 6.371e6     # Earth's radius (m)

def dynamics(t, state):
    """
    Computes the derivatives for the state vector.
    state = [x, y, vx, vy]
    """
    x, y, vx, vy = state
    r = np.sqrt(x**2 + y**2)
    ax = -mu * x / r**3
    ay = -mu * y / r**3
    return [vx, vy, ax, ay]

def collision_event(t, state):
    """
    Event function to detect collision with Earth.
    Integration stops when r - R_earth = 0.
    """
    x, y, _, _ = state
    r = np.sqrt(x**2 + y**2)
    return r - R_earth

collision_event.terminal = True
collision_event.direction = -1

def simulate_trajectory(r0, v0, t_span, t_eval):
    """
    Simulates the payload trajectory given initial conditions.
    """
    state0 = [r0[0], r0[1], v0[0], v0[1]]
    return solve_ivp(dynamics, t_span, state0, t_eval=t_eval,
                     events=collision_event, rtol=1e-8)

# Initial Conditions for 200 km altitude
altitude = 200e3                # 200 km altitude
r_mag = R_earth + altitude      # Distance from Earth's center
r0 = [r_mag, 0]                 # Starting along the x-axis

# Trajectory Cases
v_circ = np.sqrt(mu / r_mag)           # Circular Orbit speed
v0_circ = [0, v_circ]
v0_ellipse = [0, 0.8 * v_circ]         # Elliptical / Reentry (0.8×v_circ)
v_esc = np.sqrt(2 * mu / r_mag)          # Escape Velocity
v0_hyper = [0, 1.1 * v_esc]            # Hyperbolic Trajectory (1.1×v_esc)

# Time parameters
t_span = (0, 6000)  # seconds
t_eval = np.linspace(t_span[0], t_span[1], 10000)

# Simulate trajectories for 200 km altitude
sol_circ = simulate_trajectory(r0, v0_circ, t_span, t_eval)
sol_ellipse = simulate_trajectory(r0, v0_ellipse, t_span, t_eval)
sol_hyper = simulate_trajectory(r0, v0_hyper, t_span, t_eval)

# Plot the trajectories (normalized by Earth's radius)
plt.figure(figsize=(8, 8))
theta = np.linspace(0, 2*np.pi, 500)
earth_x = np.cos(theta)
earth_y = np.sin(theta)
plt.fill(earth_x, earth_y, 'b', alpha=0.3, label="Earth")
plt.plot(sol_circ.y[0] / R_earth, sol_circ.y[1] / R_earth, 'r', label="Circular Orbit")
plt.plot(sol_ellipse.y[0] / R_earth, sol_ellipse.y[1] / R_earth, 'g', label="Elliptical / Reentry")
plt.plot(sol_hyper.y[0] / R_earth, sol_hyper.y[1] / R_earth, 'm', label="Hyperbolic Trajectory")
plt.xlabel("x (in Earth radii)")
plt.ylabel("y (in Earth radii)")
plt.title("Payload Trajectories Near Earth (200 km Altitude)")
plt.legend()
plt.axis('equal')
plt.grid()
plt.show()
</code></pre>
<h4 id="explanation-of-the-code-scenario-1">Explanation of the Code (Scenario 1)</h4>
<ol>
<li>
<p><strong>Dynamics Function:</strong><br/>
   The dynamics function computes the derivatives of the state vector <span class="arithmatex">\([x, y, vx, vy]\)</span> using Newton’s law of gravitation, <span class="arithmatex">\(\ddot{\vec{r}} = -\mu \vec{r}/r^3\)</span>.</p>
</li>
<li>
<p><strong>Simulation Function:</strong><br/>
   The simulate_trajectory function sets up the initial state and integrates the equations over the defined time span using the solve_ivp solver. The collision event stops the integration when the payload intersects Earth’s surface.</p>
</li>
<li>
<p><strong>Initial Conditions:</strong> </p>
<ul>
<li>The payload is assumed to be released from a position 200 km above Earth's surface.</li>
<li>Three initial velocity cases are defined:<ul>
<li><strong>Circular orbit:</strong> using the circular velocity <span class="arithmatex">\(v_{\text{circ}} = \sqrt{\mu / r}\)</span>.</li>
<li><strong>Elliptical trajectory:</strong> using 80% of the circular velocity.</li>
<li><strong>Hyperbolic trajectory:</strong> using 110% of the escape velocity <span class="arithmatex">\(v_{\text{esc}} = \sqrt{2\mu / r}\)</span>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Plotting:</strong><br/>
   The code normalizes positions by Earth's radius to display Earth as a unit circle. Each trajectory is plotted in the <span class="arithmatex">\(xy\)</span>-plane.</p>
</li>
</ol>
<h4 id="graphical-representations-output">Graphical Representations (Output)</h4>
<p><img alt="Payload Trajectories Near Earth" src="https://raw.githubusercontent.com/akhmeed19/solutions_repo/refs/heads/main/docs/_pics/Gravity/Problem3/Payload200.png"/></p>
<h4 id="output-explanation-scenario-1">Output Explanation (Scenario 1)</h4>
<ul>
<li>
<p><strong>Blue Circle (Earth):</strong><br/>
  Represents Earth as a unit circle. The payload is released at approximately 1.03 Earth radii.</p>
</li>
<li>
<p><strong>Red Curve (Circular Orbit):</strong><br/>
  The payload maintains a tight circular orbit at 200 km altitude.</p>
</li>
<li>
<p><strong>Green Curve (Elliptical / Reentry):</strong><br/>
  With <span class="arithmatex">\(0.8 \times v_{\text{circ}}\)</span>, the payload’s trajectory intersects Earth (reentry).</p>
</li>
<li>
<p><strong>Magenta Curve (Hyperbolic Trajectory):</strong><br/>
  The payload follows an escape trajectory.</p>
</li>
</ul>
<h4 id="key-takeaways-scenario-1">Key Takeaways (Scenario 1)</h4>
<ol>
<li>Altering the initial velocity significantly changes the orbital path.</li>
<li>At 200 km, using <span class="arithmatex">\(0.8 \times v_{\text{circ}}\)</span> leads to reentry.</li>
<li>The hyperbolic trajectory clearly demonstrates escape conditions.</li>
</ol>
<hr/>
<h3 id="scenario-2-400-km-altitude">Scenario 2 (400 km Altitude)</h3>
<h4 id="code_1">Code</h4>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
mu = 3.986004418e14   # Earth's gravitational parameter (m^3/s^2)
R_earth = 6.371e6     # Earth's radius (m)

def dynamics(t, state):
    """Computes the derivatives for the state vector [x, y, vx, vy] using Newton's law."""
    x, y, vx, vy = state
    r = np.sqrt(x**2 + y**2)
    ax = -mu * x / r**3
    ay = -mu * y / r**3
    return [vx, vy, ax, ay]

def collision_event(t, state):
    """Stops integration when the payload reaches Earth's surface."""
    x, y, _, _ = state
    return np.sqrt(x**2 + y**2) - R_earth

collision_event.terminal = True
collision_event.direction = -1

def simulate_trajectory(r0, v0, t_span, t_eval):
    """Simulates the payload trajectory given initial conditions."""
    state0 = [r0[0], r0[1], v0[0], v0[1]]
    return solve_ivp(dynamics, t_span, state0, t_eval=t_eval,
                     events=collision_event, rtol=1e-8)

# Initial Conditions for 400 km altitude
altitude = 400e3                # 400 km altitude
r_mag = R_earth + altitude      # Distance from Earth's center
r0 = [r_mag, 0]                 # Starting along the x-axis

# Trajectory Cases
v_circ = np.sqrt(mu / r_mag)         # Circular Orbit speed
v0_circ = [0, v_circ]
v0_ellipse = [0, 0.9 * v_circ]       # Elliptical Orbit (bound) using 0.9×v_circ
v_esc = np.sqrt(2 * mu / r_mag)        # Escape Velocity
v0_hyper = [0, 1.1 * v_esc]          # Hyperbolic Trajectory (1.1×v_esc)

# Time parameters
t_span = (0, 6000)  # seconds
t_eval = np.linspace(t_span[0], t_span[1], 10000)

# Simulate trajectories for 400 km altitude
sol_circ_new = simulate_trajectory(r0, v0_circ, t_span, t_eval)
sol_ellipse_new = simulate_trajectory(r0, v0_ellipse, t_span, t_eval)
sol_hyper_new = simulate_trajectory(r0, v0_hyper, t_span, t_eval)

# Plot the trajectories (normalized by Earth's radius)
plt.figure(figsize=(8, 8))
theta = np.linspace(0, 2*np.pi, 500)
earth_x = np.cos(theta)
earth_y = np.sin(theta)
plt.fill(earth_x, earth_y, 'b', alpha=0.3, label="Earth")
plt.plot(sol_circ_new.y[0] / R_earth, sol_circ_new.y[1] / R_earth, 'r', label="Circular Orbit (400 km)")
plt.plot(sol_ellipse_new.y[0] / R_earth, sol_ellipse_new.y[1] / R_earth, 'g', label="Elliptical Orbit (400 km)")
plt.plot(sol_hyper_new.y[0] / R_earth, sol_hyper_new.y[1] / R_earth, 'm', label="Hyperbolic Trajectory (400 km)")
plt.xlabel("x (in Earth radii)")
plt.ylabel("y (in Earth radii)")
plt.title("Payload Trajectories at 400 km Altitude")
plt.legend()
plt.axis('equal')
plt.grid()
plt.show()
</code></pre>
<h4 id="explanation-of-the-code-scenario-2">Explanation of the Code (Scenario 2)</h4>
<ol>
<li><strong>Dynamics Function:</strong><br/>
   Computes the derivatives of the state vector <span class="arithmatex">\([x, y, vx, vy]\)</span> using Newton’s law.</li>
<li><strong>Simulation Function:</strong><br/>
   Sets up the initial state and integrates the equations over time using solve_ivp, with a collision event stopping the integration when the payload hits Earth.</li>
<li><strong>Initial Conditions (400 km):</strong> <br/>
    The payload is released from 400 km altitude (approximately 1.06 Earth radii).  <ul>
<li><strong>Circular Orbit:</strong> <span class="arithmatex">\(v = \sqrt{\mu/(R_{\text{earth}}+400\,\text{km})}\)</span></li>
<li><strong>Elliptical Orbit:</strong> <span class="arithmatex">\(v = 0.9 \times v_{\text{circ}}\)</span> (producing a bound elliptical orbit)</li>
<li><strong>Hyperbolic Trajectory:</strong> <span class="arithmatex">\(v = 1.1 \times v_{\text{esc}}\)</span></li>
</ul>
</li>
<li><strong>Plotting:</strong><br/>
   Normalizes the trajectories by Earth's radius to display Earth as a unit circle.</li>
</ol>
<h4 id="graphical-representations-output_1">Graphical Representations (Output)</h4>
<p><img alt="alt text" src="../image-19.png"/></p>
<h4 id="output-explanation-400-km-altitude">Output Explanation (400 km Altitude)</h4>
<ul>
<li><strong>Blue Circle (Earth):</strong><br/>
  Represents Earth as a unit circle; the payload starts at approximately 1.06 Earth radii.</li>
<li><strong>Red Curve (Circular Orbit):</strong><br/>
  The payload maintains a stable circular orbit at 400 km altitude.</li>
<li><strong>Green Curve (Elliptical Orbit):</strong><br/>
  With <span class="arithmatex">\(0.9 \times v_{\text{circ}}\)</span>, the payload follows a bound elliptical orbit that does not reenter.</li>
<li><strong>Magenta Curve (Hyperbolic Trajectory):</strong><br/>
  The payload follows an escape trajectory, with slight differences due to the higher altitude.</li>
</ul>
<hr/>
<h2 id="exploring-the-oberth-effect-at-periapsis">Exploring the Oberth Effect at Periapsis</h2>
<p>In this simulation, we compare two cases of a payload initially in an elliptical orbit having a periapsis at 300 km and an apogee at 600 km altitude. We consider:</p>
<ul>
<li><strong>Case 1 (No Burn):</strong> The payload follows the baseline elliptical orbit.</li>
<li><strong>Case 2 (With Burn):</strong> At periapsis—where the payload is moving fastest—a small impulsive burn is applied (adding, for example, 100 m/s to the tangential velocity). This extra energy raises the apogee significantly, thereby demonstrating the Oberth effect.</li>
</ul>
<hr/>
<h2 id="python-code">Python Code</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
mu = 3.986004418e14   # Earth's gravitational parameter (m^3/s^2)
R_earth = 6.371e6     # Earth's radius (m)

# Define orbital parameters for the elliptical orbit:
# Periapsis at 300 km and Apogee at 600 km altitude
r_p = R_earth + 300e3  # Periapsis radius
r_a = R_earth + 600e3  # Apogee radius

# Compute the velocity at periapsis for the desired elliptical orbit.
# The velocity at periapsis for an ellipse is given by:
#    v_p = sqrt(2*mu*r_a / (r_p * (r_a + r_p)))
v_p = np.sqrt(2 * mu * r_a / (r_p * (r_a + r_p)))

# Define a small delta-V to be applied at periapsis (demonstrating the Oberth effect).
delta_V = 100  # m/s

# Define two cases:
# Case 1: No burn (baseline elliptical orbit)
# Case 2: Burn applied at periapsis (adds delta_V to the tangential speed)
initial_state_no_burn = [r_p, 0, 0, v_p]         # Position at (r_p, 0), velocity (0, v_p)
initial_state_burn    = [r_p, 0, 0, v_p + delta_V]  # Position at (r_p, 0), velocity increased

# Define the dynamics using Newton's law of gravitation.
def dynamics(t, state):
    x, y, vx, vy = state
    r = np.sqrt(x**2 + y**2)
    ax = -mu * x / r**3
    ay = -mu * y / r**3
    return [vx, vy, ax, ay]

# Event function to stop integration if the payload impacts Earth.
def collision_event(t, state):
    x, y, _, _ = state
    return np.sqrt(x**2 + y**2) - R_earth
collision_event.terminal = True
collision_event.direction = -1

# Time parameters
t_span = (0, 6000)    # seconds - roughly a simulation window covering one or more orbits
t_eval = np.linspace(t_span[0], t_span[1], 10000)

# Simulate the trajectories for both cases.
sol_no_burn = solve_ivp(dynamics, t_span, initial_state_no_burn, t_eval=t_eval,
                        events=collision_event, rtol=1e-8)
sol_burn = solve_ivp(dynamics, t_span, initial_state_burn, t_eval=t_eval,
                     events=collision_event, rtol=1e-8)

# Plotting the results
plt.figure(figsize=(8, 8))
# Draw Earth as a filled circle (normalized by Earth's radius).
theta = np.linspace(0, 2*np.pi, 500)
earth_x = np.cos(theta)
earth_y = np.sin(theta)
plt.fill(earth_x, earth_y, 'b', alpha=0.3, label="Earth")

# Plot both trajectories (positions normalized by Earth's radius).
plt.plot(sol_no_burn.y[0] / R_earth, sol_no_burn.y[1] / R_earth, 'g', label="No Burn (Baseline)")
plt.plot(sol_burn.y[0] / R_earth, sol_burn.y[1] / R_earth, 'r', label="With Burn (ΔV = 100 m/s)")

plt.xlabel("x (in Earth radii)")
plt.ylabel("y (in Earth radii)")
plt.title("Effect of an Impulsive Burn at Periapsis (Oberth Effect)")
plt.legend(loc="upper right")
plt.axis('equal')
plt.grid()
plt.show()
</code></pre>
<hr/>
<h2 id="explanation-of-the-code">Explanation of the Code</h2>
<ul>
<li>
<p><strong>Orbital Parameters and Initial Conditions:</strong> </p>
<ul>
<li><strong>Altitudes:</strong><br/>
The periapsis is set at 300 km and the apogee at 600 km above Earth’s surface. These values are converted into radii by adding them to Earth's radius.</li>
<li><strong>Periapsis Velocity Calculation:</strong><br/>
The velocity at periapsis is computed with:
$$
v_p = \sqrt{\frac{2\mu \, r_a}{r_p (r_a + r_p)}}
$$
This calculation ensures that the baseline elliptical orbit will have the specified periapsis and apogee.</li>
<li><strong>Impulsive Burn:</strong><br/>
A delta‑<span class="arithmatex">\(V\)</span> of 100 m/s is applied at periapsis for the second case. Two initial state vectors are defined:</li>
<li><strong>No Burn (Baseline):</strong> <span class="arithmatex">\([r_p, 0, 0, v_p]\)</span></li>
<li><strong>With Burn:</strong> <span class="arithmatex">\([r_p, 0, 0, v_p + \Delta V]\)</span></li>
</ul>
</li>
<li>
<p><strong>Dynamics and Numerical Integration:</strong> </p>
<ul>
<li><strong>Dynamics Function:</strong><br/>
The <code>dynamics</code> function calculates the acceleration using Newton’s law of gravitation:
$$
\ddot{x} = -\frac{\mu x}{r^3}, \quad \ddot{y} = -\frac{\mu y}{r^3}
$$</li>
<li><strong>Event Function:</strong><br/>
The <code>collision_event</code> function halts the integration if the payload reaches Earth's surface (i.e., when  <span class="arithmatex">\(r = R_{\text{earth}}\)</span>).</li>
<li><strong>Integration:</strong><br/>
Both trajectories are simulated over a 6000-second window using <code>solve_ivp</code> with a tight relative tolerance of <span class="arithmatex">\(1 \times 10^{-8}\)</span> to ensure accuracy.</li>
</ul>
</li>
<li>
<p><strong>Plotting:</strong> </p>
<ul>
<li><strong>Earth Representation:</strong><br/>
Earth is plotted as a blue filled circle after normalizing positions by Earth's radius, so it appears as a unit circle.</li>
<li><strong>Trajectory Plotting:</strong><br/>
The baseline elliptical orbit (no burn) is plotted in green, and the orbit after the impulsive burn is plotted in red.</li>
<li><strong>Additional Plot Elements:</strong><br/>
Labels for the axes, a title, and a legend are included to clarify the two different scenarios.</li>
</ul>
</li>
</ul>
<hr/>
<h2 id="output-image">Output Image</h2>
<p>Below is a representative sample output image from the simulation:</p>
<h2 id="_1"><img alt="alt text" src="../image-18.png"/></h2>
<h2 id="explanation-of-the-output">Explanation of the Output</h2>
<ol>
<li>
<p><strong>Visualization Context:</strong> </p>
<ul>
<li><strong>Normalized Display:</strong><br/>
 The plot displays Earth as a blue filled unit circle since all distances are normalized by Earth's radius.</li>
<li><strong>Starting Point:</strong><br/>
 The simulation begins at a periapsis of 300 km (roughly <span class="arithmatex">\(1.05\,R_{\text{earth}}\)</span>), which places the orbits near Earth’s surface on the normalized scale.</li>
</ul>
</li>
<li>
<p><strong>Baseline Orbit (No Burn):</strong> </p>
<ul>
<li><strong>Green Curve:</strong><br/>
 The green curve represents the elliptical orbit with a periapsis at 300 km and an apogee at 600 km. This orbit follows the intended path without any modifications.</li>
</ul>
</li>
<li>
<p><strong>Orbit with Impulsive Burn (Oberth Effect):</strong> </p>
<ul>
<li><strong>Red Curve:</strong><br/>
 The red curve shows the orbit after a 100 m/s impulsive burn is applied at periapsis.</li>
<li><strong>Effect of the Burn:</strong><br/>
 The burn, performed at the point of highest orbital speed, efficiently increases the orbital energy due to the Oberth effect. This results in a significantly higher apogee compared to the baseline elliptical orbit.</li>
<li><strong>Visual Distinction:</strong><br/>
 Although the altitude differences are small relative to Earth's overall size, the divergence between the red and green curves clearly illustrates the impact of the impulsive burn.</li>
</ul>
</li>
<li>
<p><strong>General Observations:</strong> </p>
<ul>
<li>The simulation demonstrates that impulsive burns executed at periapsis are highly effective, as the added delta‑<span class="arithmatex">\(V\)</span> results in a markedly altered orbit with a raised apogee.</li>
<li>Modifying the value of <span class="arithmatex">\(\Delta V\)</span> or changing the orbital parameters would result in more pronounced visual differences.</li>
</ul>
</li>
</ol>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../Problem_2/" title="Problem 2"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../3%20Waves/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../Problem_2/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
